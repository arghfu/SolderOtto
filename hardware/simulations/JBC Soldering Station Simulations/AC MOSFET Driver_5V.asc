Version 4
SHEET 1 2400 680
WIRE -848 -480 -880 -480
WIRE -736 -480 -848 -480
WIRE -512 -480 -656 -480
WIRE 1920 -432 1888 -432
WIRE 1968 -432 1920 -432
WIRE 768 -416 752 -416
WIRE 800 -416 768 -416
WIRE 896 -416 880 -416
WIRE 928 -416 896 -416
WIRE 1040 -416 1008 -416
WIRE -1648 -400 -1856 -400
WIRE -1488 -400 -1648 -400
WIRE -1232 -400 -1488 -400
WIRE -880 -400 -880 -480
WIRE -816 -400 -880 -400
WIRE -672 -400 -720 -400
WIRE -640 -400 -672 -400
WIRE -512 -400 -512 -480
WIRE -512 -400 -544 -400
WIRE 560 -400 -512 -400
WIRE 576 -400 560 -400
WIRE 752 -384 752 -416
WIRE 880 -384 880 -416
WIRE 1040 -384 1040 -416
WIRE -1856 -368 -1856 -400
WIRE -1488 -368 -1488 -400
WIRE -304 -368 -416 -368
WIRE 32 -368 -112 -368
WIRE 144 -368 128 -368
WIRE 272 -368 144 -368
WIRE -1648 -336 -1648 -400
WIRE 1856 -336 1696 -336
WIRE 1968 -336 1968 -352
WIRE 1968 -336 1856 -336
WIRE 2000 -336 1968 -336
WIRE -736 -320 -736 -352
WIRE -704 -320 -736 -320
WIRE -640 -320 -704 -320
WIRE -624 -320 -624 -352
WIRE -624 -320 -640 -320
WIRE -576 -320 -624 -320
WIRE -560 -320 -576 -320
WIRE -448 -320 -480 -320
WIRE 1856 -320 1856 -336
WIRE -304 -304 -368 -304
WIRE -1712 -288 -1856 -288
WIRE 80 -288 80 -304
WIRE 144 -288 80 -288
WIRE 752 -288 752 -304
WIRE 880 -288 880 -304
WIRE 1040 -288 1040 -304
WIRE 1248 -288 1216 -288
WIRE 1296 -288 1248 -288
WIRE 1392 -288 1376 -288
WIRE 1488 -288 1472 -288
WIRE 1584 -288 1488 -288
WIRE 1632 -288 1584 -288
WIRE -1856 -272 -1856 -288
WIRE -1488 -272 -1488 -288
WIRE -880 -272 -880 -400
WIRE -736 -272 -736 -320
WIRE -672 -272 -672 -400
WIRE -576 -272 -576 -320
WIRE -560 -272 -576 -272
WIRE -448 -272 -448 -320
WIRE -448 -272 -496 -272
WIRE 144 -256 144 -288
WIRE 160 -256 144 -256
WIRE 272 -256 240 -256
WIRE 576 -256 576 -400
WIRE 1968 -256 1968 -336
WIRE 1584 -240 1584 -288
WIRE 1632 -240 1584 -240
WIRE -672 -224 -672 -272
WIRE -640 -224 -640 -240
WIRE -640 -224 -672 -224
WIRE -608 -224 -640 -224
WIRE -496 -224 -608 -224
WIRE 1488 -224 1488 -288
WIRE -1648 -208 -1648 -240
WIRE -1552 -208 -1648 -208
WIRE -1328 -208 -1328 -256
WIRE -1232 -208 -1232 -400
WIRE -608 -208 -608 -224
WIRE -448 -208 -448 -272
WIRE -368 -208 -368 -224
WIRE -368 -208 -448 -208
WIRE -304 -208 -368 -208
WIRE 0 -208 -32 -208
WIRE 64 -208 0 -208
WIRE 272 -208 272 -256
WIRE 272 -208 144 -208
WIRE 320 -208 272 -208
WIRE 336 -208 320 -208
WIRE 1584 -208 1584 -240
WIRE 1856 -208 1856 -240
WIRE 1904 -208 1856 -208
WIRE -1744 -192 -1856 -192
WIRE -1648 -192 -1648 -208
WIRE 1632 -192 1632 -240
WIRE 1760 -192 1632 -192
WIRE 1856 -192 1856 -208
WIRE 336 -176 336 -208
WIRE 912 -176 864 -176
WIRE 1008 -176 992 -176
WIRE 1216 -176 1216 -192
WIRE -1856 -160 -1856 -192
WIRE -880 -144 -880 -192
WIRE -496 -144 -496 -224
WIRE -304 -144 -496 -144
WIRE 576 -144 576 -176
WIRE 688 -144 576 -144
WIRE 800 -144 768 -144
WIRE 864 -144 864 -176
WIRE 864 -144 800 -144
WIRE -2048 -128 -2048 -176
WIRE -672 -128 -672 -160
WIRE -608 -128 -608 -144
WIRE -608 -128 -672 -128
WIRE -416 -128 -416 -368
WIRE -416 -128 -608 -128
WIRE 576 -128 576 -144
WIRE 1392 -128 1392 -288
WIRE -1920 -112 -1952 -112
WIRE -672 -112 -672 -128
WIRE -64 -112 -112 -112
WIRE 800 -112 800 -144
WIRE 912 -112 912 -128
WIRE -1648 -96 -1648 -112
WIRE -1328 -96 -1328 -128
WIRE -1232 -96 -1232 -128
WIRE -1232 -96 -1328 -96
WIRE -1152 -96 -1232 -96
WIRE 864 -96 864 -144
WIRE 880 -96 864 -96
WIRE 1488 -96 1488 -144
WIRE 1584 -96 1584 -144
WIRE 1584 -96 1488 -96
WIRE 1696 -96 1696 -240
WIRE 1696 -96 1584 -96
WIRE 1808 -96 1808 -128
WIRE 1808 -96 1696 -96
WIRE 1968 -96 1968 -160
WIRE 1968 -96 1808 -96
WIRE -1952 -80 -1952 -112
WIRE -1744 -80 -1744 -192
WIRE 1008 -80 1008 -176
WIRE 1008 -80 944 -80
WIRE 1040 -80 1008 -80
WIRE 1088 -80 1040 -80
WIRE 1216 -80 1216 -96
WIRE 1216 -80 1168 -80
WIRE 1264 -80 1216 -80
WIRE 1808 -80 1808 -96
WIRE -1232 -64 -1232 -96
WIRE 272 -64 272 -208
WIRE 272 -64 80 -64
WIRE 336 -64 336 -96
WIRE 880 -64 864 -64
WIRE 1216 -64 1216 -80
WIRE -2048 -32 -2048 -48
WIRE -1856 -32 -1856 -64
WIRE -1856 -32 -2048 -32
WIRE -1808 -32 -1856 -32
WIRE 912 -32 912 -48
WIRE -672 -16 -672 -32
WIRE 576 -16 576 -48
WIRE 688 -16 576 -16
WIRE 800 -16 800 -48
WIRE 800 -16 768 -16
WIRE 864 -16 864 -64
WIRE 864 -16 800 -16
WIRE -64 0 -64 -16
WIRE 800 0 800 -16
WIRE -2048 16 -2048 -32
WIRE 1216 16 1216 0
WIRE -1232 32 -1232 16
WIRE 576 32 576 -16
WIRE 2272 32 2240 32
WIRE 2288 32 2272 32
WIRE -1744 48 -1744 16
WIRE 1632 48 1584 48
WIRE 1728 48 1712 48
WIRE -672 64 -672 48
WIRE 2240 64 2240 32
WIRE 1392 80 1392 -128
WIRE 1424 80 1392 80
WIRE 1520 80 1504 80
WIRE 1584 80 1584 48
WIRE 1584 80 1520 80
WIRE -2048 112 -2048 96
WIRE 1520 112 1520 80
WIRE 1632 112 1632 96
WIRE 1584 128 1584 80
WIRE 1600 128 1584 128
WIRE 1728 144 1728 48
WIRE 1728 144 1664 144
WIRE 1760 144 1728 144
WIRE 1888 144 1840 144
WIRE 1600 160 1584 160
WIRE 2016 160 1952 160
WIRE 2032 160 2016 160
WIRE 2144 160 2112 160
WIRE 2240 160 2240 128
WIRE 2240 160 2144 160
WIRE 2320 160 2240 160
WIRE 1888 176 1840 176
WIRE 2240 176 2240 160
WIRE 1632 192 1632 176
WIRE 2144 192 2144 160
WIRE 1376 208 1344 208
WIRE 1424 208 1376 208
WIRE 1520 208 1520 176
WIRE 1520 208 1504 208
WIRE 1584 208 1584 160
WIRE 1584 208 1520 208
WIRE 1520 240 1520 208
WIRE 1840 256 1840 176
WIRE 1920 256 1840 256
WIRE 2016 256 2016 160
WIRE 2016 256 2000 256
WIRE 1840 272 1840 256
WIRE 2144 272 2144 256
WIRE 2240 272 2240 240
WIRE 1520 336 1520 320
FLAG 320 -208 SW
FLAG 336 -64 0
FLAG -880 -144 0
FLAG -672 64 0
FLAG 576 32 0
FLAG -32 -272 0
FLAG 1040 -288 0
FLAG -64 0 0
FLAG 560 -400 Vout
FLAG -704 -320 Gate
FLAG -672 -400 Src
FLAG -848 -480 23Vac
FLAG -2048 -176 23Vac
FLAG -2048 112 0
FLAG -1744 48 0
FLAG -1648 -96 0
FLAG -1552 -208 ZCD
IOPIN -1552 -208 Out
FLAG -1488 -272 0
FLAG -1328 -256 23Vac
FLAG -1232 32 0
FLAG -1152 -96 AN
IOPIN -1152 -96 Out
FLAG 800 80 0
FLAG 752 -288 0
FLAG 880 -288 0
FLAG 768 -416 8
FLAG 912 -128 8
FLAG 896 -416 -4.4
FLAG 912 -32 -4.4
FLAG 1008 -416 3.3
FLAG 1216 -192 3.3
FLAG 1264 -80 Iadc
IOPIN 1264 -80 Out
FLAG 1216 16 0
FLAG 1040 -80 Iout
FLAG 0 -208 3.3
FLAG 272 -368 3.3
FLAG 1248 -288 Vout
FLAG 1808 -80 0
FLAG 1920 -432 3.3
FLAG 2000 -336 DET
IOPIN 2000 -336 Out
FLAG 1392 -128 TC
FLAG 1376 208 Vout
FLAG 1632 96 8
FLAG 1632 192 -4.4
FLAG 2320 160 Temp
FLAG 1840 352 0
FLAG 1920 128 -4.4
FLAG 1920 192 8
FLAG 1520 336 0
FLAG 2144 272 0
FLAG 2240 272 0
FLAG 2272 32 3.3
FLAG -1952 -80 0
SYMBOL Optos\\4N25 -208 -144 M0
WINDOW 0 65 64 Center 2
WINDOW 3 -58 64 Center 2
SYMATTR InstName U1
SYMBOL nmos -816 -352 R270
WINDOW 0 97 22 VRight 2
WINDOW 3 68 -4 VRight 2
SYMATTR InstName M1
SYMATTR Value FDS5670
SYMBOL nmos -544 -352 M270
WINDOW 0 95 62 VLeft 2
WINDOW 3 70 91 VLeft 2
SYMATTR InstName M2
SYMATTR Value FDS5670
SYMBOL voltage -880 -288 R0
WINDOW 3 -47 75 Right 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 -153 41 Left 2
SYMATTR Value SINE(0 {1.414*23.5} 50)
SYMATTR InstName V_Source
SYMBOL voltage 336 -192 R0
WINDOW 3 -240 166 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(5 0 0 1us 1us 20ms 30ms 4)
SYMATTR InstName V2
SYMBOL res 560 -160 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R_Load
SYMATTR Value 10
SYMBOL diode -656 48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value BAS16HY
SYMBOL res -688 -128 R0
WINDOW 0 -37 39 Left 2
WINDOW 3 -43 77 Left 2
SYMATTR InstName R2
SYMATTR Value 2k2
SYMBOL zener -688 -224 R0
WINDOW 0 -34 11 Left 2
WINDOW 3 -137 36 Left 2
SYMATTR InstName D2
SYMATTR Value BZX84C18VLY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -640 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10Meg
SYMBOL res -464 -336 R90
WINDOW 0 -1 70 VBottom 2
WINDOW 3 -21 16 VTop 2
SYMATTR InstName R5
SYMATTR Value 5k6
SYMBOL res 560 -32 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Isense
SYMATTR Value 5m
SYMBOL cap -624 -208 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL diode -672 -288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 21 105 VTop 2
SYMATTR InstName D3
SYMATTR Value BAV70HY
SYMBOL diode -496 -288 R90
WINDOW 0 11 -9 VBottom 2
WINDOW 3 35 12 VTop 2
SYMATTR InstName D4
SYMATTR Value BAV70HY
SYMBOL Optos\\4N25 -208 -304 M0
WINDOW 0 67 63 Center 2
SYMATTR InstName U2
SYMBOL res -384 -320 R0
SYMATTR InstName R4
SYMATTR Value 1k5
SYMBOL res -16 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 330
SYMBOL res -16 -224 R90
WINDOW 0 63 78 VBottom 2
WINDOW 3 34 27 VTop 2
SYMATTR InstName R7
SYMATTR Value 330
SYMBOL voltage 1040 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 3.3
SYMBOL res 160 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL npn 0 -112 M0
WINDOW 0 75 18 Left 2
WINDOW 3 30 48 Left 2
SYMATTR InstName Q1
SYMATTR Value BC847A
SYMBOL pnp 32 -304 R270
WINDOW 0 65 31 VRight 2
WINDOW 3 37 -89 VRight 2
SYMATTR InstName Q2
SYMATTR Value BC858B
SYMBOL res 128 -384 R0
WINDOW 0 45 44 Left 2
WINDOW 3 46 65 Left 2
SYMATTR InstName R9
SYMATTR Value 7k5
SYMBOL res 96 -80 R90
WINDOW 0 -3 66 VBottom 2
WINDOW 3 40 63 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 256 -272 R90
WINDOW 0 -3 42 VBottom 2
WINDOW 3 31 50 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -2064 -144 R0
SYMATTR InstName R3
SYMATTR Value 22k
SYMBOL res -2064 0 R0
SYMATTR InstName R12
SYMATTR Value 1Meg
SYMBOL npn -1808 -80 R0
WINDOW 0 75 18 Left 2
WINDOW 3 30 48 Left 2
SYMATTR InstName Q3
SYMATTR Value BC847A
SYMBOL npn -1920 -160 R0
WINDOW 0 75 18 Left 2
WINDOW 3 30 48 Left 2
SYMATTR InstName Q4
SYMATTR Value BC847A
SYMBOL res -1664 -208 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -1872 -288 R0
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -1872 -384 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL pnp -1712 -240 M180
WINDOW 0 65 31 VRight 2
WINDOW 3 97 9 VRight 2
SYMATTR InstName Q5
SYMATTR Value BC858B
SYMBOL voltage -1488 -384 R0
WINDOW 0 41 59 Left 2
WINDOW 3 39 85 Left 2
SYMATTR InstName V3
SYMATTR Value 3.3V
SYMBOL res -1248 -224 R0
SYMATTR InstName R16
SYMATTR Value 100k
SYMBOL res -1248 -80 R0
SYMATTR InstName R17
SYMATTR Value 100k
SYMBOL res -1344 -224 R0
SYMATTR InstName R18
SYMATTR Value 1Meg
SYMBOL Opamps\\OP07 912 -144 R0
SYMATTR InstName U3
SYMBOL res 784 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 20k
SYMBOL res 784 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 20k
SYMBOL cap 784 -112 R0
SYMATTR InstName C2
SYMATTR Value 47p
SYMBOL res 784 -16 R0
SYMATTR InstName R21
SYMATTR Value 453k
SYMBOL res 1008 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 453k
SYMBOL voltage 752 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 8
SYMBOL voltage 880 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value -4.4
SYMBOL res 1184 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 3k3
SYMBOL res 1232 -80 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R24
SYMATTR Value 3k3
SYMBOL cap 1200 -64 R0
SYMATTR InstName C3
SYMATTR Value 1n
SYMBOL res -656 -336 R0
WINDOW 0 30 48 Left 2
WINDOW 3 25 84 Left 2
SYMATTR InstName R25
SYMATTR Value 1Meg
SYMBOL voltage 1392 -288 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -47 45 VRight 2
WINDOW 3 46 42 VRight 2
SYMATTR InstName V6
SYMATTR Value -5.5m
SYMBOL res 1488 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 470k
SYMBOL res 1472 -240 R0
SYMATTR InstName R27
SYMATTR Value 47k
SYMBOL cap 1568 -208 R0
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL npn 1632 -336 R0
WINDOW 0 75 18 Left 2
WINDOW 3 30 48 Left 2
SYMATTR InstName Q6
SYMATTR Value BC847A
SYMBOL npn 1856 -128 M270
WINDOW 0 61 65 VLeft 2
WINDOW 3 104 100 VLeft 2
SYMATTR InstName Q7
SYMATTR Value BC847A
SYMBOL res 1840 -336 R0
SYMATTR InstName R28
SYMATTR Value 47k
SYMBOL pnp 1904 -160 M180
WINDOW 0 54 65 Left 2
WINDOW 3 57 39 Left 2
SYMATTR InstName Q8
SYMATTR Value BC858B
SYMBOL res 1952 -448 R0
SYMATTR InstName R29
SYMATTR Value 10k
SYMBOL res 1520 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 22k6
SYMBOL res 1520 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 22k6
SYMBOL Opamps\\OP07 1632 80 R0
SYMATTR InstName U4
SYMBOL cap 1504 112 R0
SYMATTR InstName C5
SYMATTR Value 47p
SYMBOL res 1728 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 590k
SYMBOL Opamps\\opamp2 1920 224 M180
SYMATTR InstName U5
SYMATTR Value LM358
SYMBOL res 1856 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R32
SYMATTR Value 2k7
SYMBOL res 1856 368 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R34
SYMATTR Value 2k7
SYMBOL res 1904 272 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R35
SYMATTR Value 22k6
SYMBOL res 1504 224 R0
SYMATTR InstName R36
SYMATTR Value 590k
SYMBOL res 2128 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 2k2
SYMBOL cap 2128 192 R0
SYMATTR InstName C6
SYMATTR Value 1n
SYMBOL schottky 2256 128 R180
WINDOW 0 24 64 Left 2
WINDOW 3 42 32 Left 2
SYMATTR InstName D5
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 2256 240 R180
WINDOW 0 -44 39 Left 2
WINDOW 3 -78 0 Left 2
SYMATTR InstName D6
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
TEXT -504 24 Left 2 !.tran 0 70m 10ms uic
TEXT -216 -128 Left 2 ;Off
TEXT -216 -288 Left 2 ;On
TEXT -1744 -456 Left 2 ;Zero cross detection
TEXT -200 -464 Left 2 ;MOSFET Driver
TEXT 1320 -304 Left 2 ;TC
TEXT 1216 304 Left 2 !.include LM358.mod
TEXT 1216 -368 Left 2 ;200ºC -> -5.5m
TEXT 1592 -16 Left 2 ;Temperature sensing
